<!doctype html><html dir=ltr lang=en data-theme class=html><head><title>Eugene Khvedchenya
|
A complete iOS + OpenCV sample project</title><meta charset=utf-8><meta name=generator content="Hugo 0.98.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content="Eugene Khvedchenya"><meta name=description content="A personal blog about Computer Vision, AI, Kaggle, Open-Source and research. You will never read this in books."><link rel=stylesheet href=/scss/main.min.b2e0cb07595e3519ab1193bb421914e06c0e26b0cc561fef23b3c6131d4d2ffa.css integrity="sha256-suDLB1leNRmrEZO7QhkU4GwOJrDMVh/vI7PGEx1NL/o=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.31b0a1f317f55c529a460897848c97436bb138b19c399b37de70d463a8bf6ed5.css integrity="sha256-MbCh8xf1XFKaRgiXhIyXQ2uxOLGcOZs33nDUY6i/btU=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=canonical href=https://computer-vision-talks.com/post/2011-08-14-a-complete-ios-opencv-sample-project/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.560a26330d27ff44a44e83b53cd07a95d4230a65930d31c5c76a8d481e5b35bf.js integrity="sha256-VgomMw0n/0SkToO1PNB6ldQjCmWTDTHFx2qNSB5bNb8=" crossorigin=anonymous></script><meta name=twitter:card content="summary"><meta name=twitter:title content="A complete iOS + OpenCV sample project"><meta name=twitter:description content="Hello everyone! Today i want to introduce the all new tutorial project of using OpenCV in your iOS projects. In this post i&rsquo;ll show you the right and correct way of interoperation between native OpenCV C/C++ API and Objective-C. I know many of you asked me how to solve this nasty &ldquo;statement-expressions are allowed only inside functions&rdquo; error. Here is a solution.
The conflict occurs because both UIKit.h and opencv_core.h define the same MIN symbol."><meta property="og:title" content="A complete iOS + OpenCV sample project"><meta property="og:description" content="Hello everyone! Today i want to introduce the all new tutorial project of using OpenCV in your iOS projects. In this post i&rsquo;ll show you the right and correct way of interoperation between native OpenCV C/C++ API and Objective-C. I know many of you asked me how to solve this nasty &ldquo;statement-expressions are allowed only inside functions&rdquo; error. Here is a solution.
The conflict occurs because both UIKit.h and opencv_core.h define the same MIN symbol."><meta property="og:type" content="article"><meta property="og:url" content="https://computer-vision-talks.com/post/2011-08-14-a-complete-ios-opencv-sample-project/"><meta property="article:section" content="post"><meta property="article:published_time" content="2011-08-14T00:00:00+00:00"><meta property="article:modified_time" content="2011-08-14T00:00:00+00:00"><meta property="og:site_name" content="Computer Vision Talks"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"post","name":"A complete iOS \u002b OpenCV sample project","headline":"A complete iOS \u002b OpenCV sample project","alternativeHeadline":"","description":"
      
        Hello everyone! Today i want to introduce the all new tutorial project of using OpenCV in your iOS projects. In this post i\u0026rsquo;ll show you the right and correct way of interoperation between native OpenCV C\/C\u002b\u002b API and Objective-C. I know many of you asked me how to solve this nasty \u0026ldquo;statement-expressions are allowed only inside functions\u0026rdquo; error. Here is a solution.\nThe conflict occurs because both UIKit.h and opencv_core.h define the same MIN symbol.


      


    ","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/computer-vision-talks.com\/post\/2011-08-14-a-complete-ios-opencv-sample-project\/"},"author":{"@type":"Person","name":"Eugene Khvedchenya"},"creator":{"@type":"Person","name":"Eugene Khvedchenya"},"accountablePerson":{"@type":"Person","name":"Eugene Khvedchenya"},"copyrightHolder":{"@type":"Person","name":"Eugene Khvedchenya"},"copyrightYear":"2011","dateCreated":"2011-08-14T00:00:00.00Z","datePublished":"2011-08-14T00:00:00.00Z","dateModified":"2011-08-14T00:00:00.00Z","publisher":{"@type":"Organization","name":"Eugene Khvedchenya","url":"https://computer-vision-talks.com/","logo":{"@type":"ImageObject","url":"https:\/\/computer-vision-talks.com\/favicon-32x32.png","width":"32","height":"32"}},"image":[],"url":"https:\/\/computer-vision-talks.com\/post\/2011-08-14-a-complete-ios-opencv-sample-project\/","wordCount":"698","genre":[],"keywords":["opencv","xcode"]}</script></head><body class="body theme--light"><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
animated fadeInDown"><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src=/images/4ECfkGJr_400x400.jpg alt="profile picture"><div class=sidebar__introduction-title><a href=/>Computer Vision Talks</a></div><div class=sidebar__introduction-description><p>A personal blog about Computer Vision, AI, Kaggle, Open-Source and research. You will never read this in books.</p></div></div><ul class=sidebar__list><li class=sidebar__list-item><a href=https://www.linkedin.com/in/cvtalks/ target=_blank rel=noopener aria-label=Linkedin title=Linkedin><i class="fab fa-linkedin fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://twitter.com/cvtalks target=_blank rel=noopener aria-label=Twitter title=Twitter><i class="fab fa-twitter fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://github.com/BloodAxe target=_blank rel=noopener aria-label=GitHub title=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=mailto:ekhvedchenya@computer-vision-talks.com target=_blank rel=noopener aria-label=E-Mail title=E-Mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
Eugene Khvedchenya
2022</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.9c062c557275acbaba71f0c7cd4024da3e3cc825d248bc4b2130811b0965330b.js integrity="sha256-nAYsVXJ1rLq6cfDHzUAk2j48yCXSSLxLITCBGwllMws=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-10687369-5","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></div></aside><main class=wrapper__main><header class=header><div class="animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu><li class=nav__list-item><a href=/ title>Home</a></li><li class=nav__list-item><a href=/post/ title>Posts</a></li><li class=nav__list-item><a href=/open-source title>Open-Source</a></li><li class=nav__list-item><a href=/challenges title>Wins</a></li><li class=nav__list-item><a href=/publications title>Publications</a></li></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
animated fadeInDown"><div class=post__content><h1>A Complete IOS + OpenCV Sample Project</h1><ul class=post__meta><li class=post__meta-item><em class="fas fa-calendar-day post__meta-icon"></em>
<span class=post__meta-text>Sun, Aug 14, 2011</span></li><li class=post__meta-item><em class="fas fa-stopwatch post__meta-icon"></em>
<span class=post__meta-text>4-minute read</span></li></ul><p><img src=img_thumb.png alt="OpenCV iOS Sample Project" title="OpenCV iOS Sample Project">Hello everyone! Today i want to introduce the all new tutorial project of using OpenCV in your iOS projects. In this post i&rsquo;ll show you the right and correct way of interoperation between native OpenCV C/C++ API and Objective-C. I know many of you asked me how to solve this nasty &ldquo;statement-expressions are allowed only inside functions&rdquo; error. Here is a solution.</p><p></p><p>The conflict occurs because both UIKit.h and opencv_core.h define the same MIN symbol. But in UIKit it’s a function, and a macro in OpenCV. If you include bot iOS framework and core.h header file from OpenCV they will conflict with MIN symbol because iOS define MIN function, but the OpenCV has the MAX macros. The simple way would be to ask OpenCV maintainers to give other name to MIN macros. But it&rsquo;s too easy and i do not believe it&rsquo;s right solution.</p><p>The correct way is to split the business logic from the presentation layer into different parts of the project, so the iOS frameworks and OpenCV includes never appears in single compilation unit.</p><p>In this tutorial i consider a sample application, which takes images from the photo album, does some image processing and then displays the processed bitmaps to the user. So the idea to differentiate the UI from the image processing.</p><p>Let&rsquo;s do it in this way.</p><ol><li>Declare the API interface used by the View. This API is the only thing that View know about.</li><li>Write and particular C++ implementation of the image processing component.</li><li>Write an implementation of the API protocol that implements desired methods and delegates calls to the C++ implementation doing data conversion if necessary.</li></ol><p>A small diagram that illustrates the idea:</p><p><img src=OpenCV-iOS-Architecture_thumb.png alt="OpenCV  iOS Architecture" title="OpenCV  iOS Architecture"></p><p>Here is a code of the protocol declaration:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objectivec data-lang=objectivec><span class=line><span class=cl><span class=k>@protocol</span> <span class=nc>ImageProcessingProtocol</span> <span class=o>&lt;</span> <span class=n>NSObject</span> <span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=p>(</span><span class=n>UIImage</span><span class=o>*</span><span class=p>)</span> <span class=nl>processImage</span><span class=p>:(</span><span class=n>UIImage</span><span class=o>*</span><span class=p>)</span> <span class=n>src</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>@end</span>
</span></span></code></pre></div><p>As you can see it&rsquo;s pretty simple - it sends the image to processing component and return the result. I pay your attention to the fact that user code at this point know nothing about OpenCV. In the view you work with this API like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objectivec data-lang=objectivec><span class=line><span class=cl><span class=p>-</span> <span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=nf>imagePickerController:</span><span class=p>(</span><span class=n>UIImagePickerController</span> <span class=o>*</span><span class=p>)</span><span class=nv>picker</span>
</span></span><span class=line><span class=cl>        <span class=nf>didFinishPickingImage:</span><span class=p>(</span><span class=n>UIImage</span> <span class=o>*</span><span class=p>)</span><span class=nv>image</span>
</span></span><span class=line><span class=cl>                  <span class=nf>editingInfo:</span><span class=p>(</span><span class=n>NSDictionary</span> <span class=o>*</span><span class=p>)</span><span class=nv>editingInfo</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>picker</span> <span class=nl>dismissModalViewControllerAnimated</span><span class=p>:</span><span class=nb>YES</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>iOSplusOpenCVAppDelegate</span> <span class=o>*</span> <span class=n>appDelegate</span> <span class=o>=</span> <span class=p>[[</span><span class=n>UIApplication</span> <span class=n>sharedApplication</span><span class=p>]</span> <span class=n>delegate</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Process the input image and present the result:
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>UIImage</span> <span class=o>*</span> <span class=n>processedImage</span> <span class=o>=</span> <span class=p>[</span><span class=n>appDelegate</span><span class=p>.</span><span class=n>imageProcessor</span> <span class=nl>processImage</span><span class=p>:</span><span class=n>image</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=nb>self</span><span class=p>.</span><span class=n>mainButton</span><span class=p>.</span><span class=n>imageView</span><span class=p>.</span><span class=n>image</span> <span class=o>=</span> <span class=n>processedImage</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Now let&rsquo;s write the actual processing code. In this project I use Boost.Gil to pass raw image data to OpenCV because I prefer this strongly typed image concepts very much and use Boost for it is a good choice. You can read about Boost.Gil here: <a href=http://www.boost.org/doc/libs/1_46_1/libs/gil/doc/index.html>Boost Gil library overview</a>.</p><p>Declaration of OpenCVImageProcessor class:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>_IplImage</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>typedef</span> <span class=n>_IplImage</span> <span class=n>IplImage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OpenCVImageProcessor</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=k>public</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=n>process</span><span class=p>(</span><span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>bgr8_view_t</span> <span class=n>src</span><span class=p>,</span> <span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>bgr8_view_t</span> <span class=n>dst</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span><span class=o>:</span>
</span></span><span class=line><span class=cl>    <span class=n>IplImage</span> <span class=n>getIplImageView</span><span class=p>(</span><span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>bgr8_view_t</span> <span class=n>srcView</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>IplImage</span> <span class=nf>getIplImageView</span><span class=p>(</span><span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>gray8_view_t</span> <span class=n>srcView</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p>Implementation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>// A helper macro
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=cp>#define GIL2CV(GilView) getIplImageView(GilView)
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=n>OpenCVImageProcessor</span><span class=o>::</span><span class=n>process</span><span class=p>(</span><span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>bgr8_view_t</span> <span class=n>src</span><span class=p>,</span> <span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>bgr8_view_t</span> <span class=n>dst</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>BOOST_ASSERT</span><span class=p>(</span><span class=n>src</span><span class=p>.</span><span class=n>dimensions</span><span class=p>()</span> <span class=o>==</span> <span class=n>dst</span><span class=p>.</span><span class=n>dimensions</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>gray8_image_t</span> <span class=n>srcGray</span><span class=p>(</span><span class=n>src</span><span class=p>.</span><span class=n>dimensions</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>gray8_image_t</span> <span class=n>edges</span><span class=p>(</span><span class=n>src</span><span class=p>.</span><span class=n>dimensions</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>IplImage</span> <span class=n>srcIplImage</span>     <span class=o>=</span> <span class=n>GIL2CV</span><span class=p>(</span><span class=n>src</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>IplImage</span> <span class=n>srcGrayIplImage</span> <span class=o>=</span> <span class=n>GIL2CV</span><span class=p>(</span><span class=n>srcGray</span><span class=p>.</span><span class=n>_view</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>IplImage</span> <span class=n>edgesIplImage</span>   <span class=o>=</span> <span class=n>GIL2CV</span><span class=p>(</span><span class=n>edges</span><span class=p>.</span><span class=n>_view</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>IplImage</span> <span class=n>dstIplImage</span>     <span class=o>=</span> <span class=n>GIL2CV</span><span class=p>(</span><span class=n>dst</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cvCvtColor</span><span class=p>(</span><span class=o>&amp;</span><span class=n>srcIplImage</span><span class=p>;,</span> <span class=o>&amp;</span><span class=n>srcGrayIplImage</span><span class=p>;,</span> <span class=n>CV_BGR2GRAY</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cvCanny</span><span class=p>(</span><span class=o>&amp;</span><span class=n>srcGrayIplImage</span><span class=p>;,</span> <span class=o>&amp;</span><span class=n>edgesIplImage</span><span class=p>;,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>50</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cvCvtColor</span><span class=p>(</span><span class=o>&amp;</span><span class=n>edgesIplImage</span><span class=p>;,</span> <span class=o>&amp;</span><span class=n>dstIplImage</span><span class=p>;,</span> <span class=n>CV_GRAY2BGR</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Almost done. Now we have write and implementation for the ImageProcessingProtocol (I omit the image conversion functions because they are pretty standard and simple):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-objectivec data-lang=objectivec><span class=line><span class=cl><span class=k>@interface</span> <span class=nc>ImageProcessingImpl</span> : <span class=nc>NSObject</span>
</span></span><span class=line><span class=cl><span class=p>-</span> <span class=p>(</span><span class=n>UIImage</span><span class=o>*</span><span class=p>)</span> <span class=nf>processImage:</span><span class=p>(</span><span class=n>UIImage</span><span class=o>*</span><span class=p>)</span> <span class=nv>src</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>@end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>@implementation</span> <span class=nc>ImageProcessingImpl</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>-</span> <span class=p>(</span><span class=n>UIImage</span><span class=o>*</span><span class=p>)</span> <span class=nf>processImage:</span><span class=p>(</span><span class=n>UIImage</span><span class=o>*</span><span class=p>)</span> <span class=nv>src</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>OpenCVImageProcessor</span> <span class=n>processor</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>bgr8_image_t</span> <span class=n>srcImage</span> <span class=o>=</span> <span class=p>[</span><span class=nb>self</span> <span class=nl>convertUIImageToGILImage</span><span class=p>:</span><span class=n>src</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=n>boost</span><span class=o>::</span><span class=n>gil</span><span class=o>::</span><span class=n>bgr8_image_t</span> <span class=n>dstImage</span><span class=p>(</span><span class=n>srcImage</span><span class=p>.</span><span class=n>dimensions</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>processor</span><span class=p>.</span><span class=n>process</span><span class=p>(</span><span class=n>view</span><span class=p>(</span><span class=n>srcImage</span><span class=p>),</span> <span class=n>view</span><span class=p>(</span><span class=n>dstImage</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>[</span><span class=nb>self</span> <span class=nl>convertGILImageToUIImage</span><span class=p>:</span><span class=n>dstImage</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>@end</span>
</span></span></code></pre></div><p>And that’s all. With this approach you receive flexible design with strict API and platform-independent implementation. You probably can even port it to Android platform by simply writing an adopted ImageProcessingAndroidImpl wrapper.</p><p>The final application looks like on this screenshots:</p><p><img src=1_thumb.png alt=1 title=1></p><p>At startup user asked to choose the source image by tapping on screen and then the detected edges are shown. To choose another image – just tap on the screen again.</p><p><strong>Advantages:</strong></p><ul><li>No explicit dependency from OpenCV in your UI.</li><li>No violation of MVC and SRP paradigm.</li><li>The View code looks more clear and easy to understand.</li><li>Really cross-platform solution.</li></ul><p><strong>Disadvantages:</strong></p><ul><li>Need to write a bit more code.</li><li>You need some proxy types to pass Obj-C data (images) to the OpenCV. I use Boost.Gil for this.</li></ul><h4 id=conclusion><strong>Conclusion:</strong></h4><p>The source code for this sample can be found on my GitHub: <a href=https://github.com/BloodAxe/opencv-ios-template-project>https://github.com/BloodAxe/opencv-ios-template-project</a>.</p></div><div class=post__footer><span><a class=tag href=/tags/opencv/>opencv</a><a class=tag href=/tags/xcode/>xcode</a></span></div><div id=comment><h2>comments</h2><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//cvtalks.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
Eugene Khvedchenya
2022</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.9c062c557275acbaba71f0c7cd4024da3e3cc825d248bc4b2130811b0965330b.js integrity="sha256-nAYsVXJ1rLq6cfDHzUAk2j48yCXSSLxLITCBGwllMws=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-10687369-5","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>